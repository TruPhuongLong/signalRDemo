<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="Scripts/jquery-1.10.2.min.js"></script>
    <script src="Scripts/jquery.signalR-2.1.2.min.js"></script>

    <script src="/signalr/hubs"></script>
    <script>
        $(function () {
            const hub = $.connection.echo1;

            // listId:
            hub.client.listId = function (listId) {
                console.log(listId);
            }

            // get mes:
            hub.client.message = function (message) {
                var li = $('<li/>').html(message);
                $('#messages').append(li);
            };


            $.connection.hub
                .start()
                .done(function () {
                    let group;

                    // subcribe group:
                    $('#subcribe').click(function () {
                        group = $('#group').val();
                        hub.server.subcribe(group);
                        toggle();
                        $('#displayGroup').html("You are in group: " + group);
                    });

                    // unSubcribe group:
                    $('#unSubcribe').click(function () {
                        hub.server.unSubcribe(group);
                        toggle();
                    });

                    //=====================send message=================
                    // send mes:
                    $('#messageAll').click(function () {
                        hub.server.messageAll($('#input').val());
                    });

                    $('#messageCaller').click(function () {
                        hub.server.messageCaller($('#input').val());
                    });

                    $('#messageGroup').click(function () {
                        hub.server.messageGroup($('#input').val(), $('#group').val());
                    });

                    $('#messageOthers').click(function () {
                        hub.server.messageOthers($('#input').val());
                    });

                    $('#messageAllExcept').click(function () {
                        hub.server.messageAllExcept($('#input').val(), $('#exceptId').val());
                    });

                    
                });

            var toggle = function () {
                $('#g1').toggle();
                $('#g2').toggle();
            }

        });
    </script>

</head>
<body>

    <h1>Chat Page</h1>
    <div id="g1">
        <button id="subcribe">subcribe group</button>
        <br /> <br />
        <select id="group">
            <option value="hcm">Ho Chi Minh</option>
            <option value="hn">Ha Noi</option>
            <option value="ko">Korean</option>
            <option value="lo">London</option>
        </select>
    </div>
    <br /> <br />
           <div id="g2" style="display: none">
               <h1 id="displayGroup"></h1>
               <br /><br />
                      <button id="unSubcribe">unSubcribe</button>
               <br /> <br />
                      <button id="messageAll">messageAll</button>
               <br /> <br />
                      <button id="messageCaller">messageCaller</button>
               <br /> <br />
                      <button id="messageGroup">messageGroup</button>
               <br /> <br />
                      <button id="messageOthers">messageOthers</button>
               <br /> <br />
                      <button id="messageAllExcept">messageAllExcept</button>

               <br /> <br />
               <input id="input" placeholder="mes" />
               <br /><br />
               <input id="exceptId" placeholder="exceptId" />
           </div>



    <ul id="messages"></ul>
    <hr />


</body>
</html>