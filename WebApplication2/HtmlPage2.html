<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="Scripts/jquery-1.10.2.min.js"></script>
    <script src="Scripts/jquery.signalR-2.1.2.min.js"></script>
    <script src="/signalr/hubs"></script>
    <!--<script>
        $(function () {
            const hub = $.connection.echo1;
            hub.client.message = function (mes) {
                $('#message').append($('<li />').hmtl(mes));
            }
            $.connection.hub
                .start()
                .done(function () {


                    // send message and get here with value return from server:
                    $('#send').click(function () {
                        hub.server.returnMessage($('#text').val())
                            .done(function (mes) {
                                $('#message').append($('<li />').html(mes));
                            })
                    })
                });
        });
    </script>-->

    <script>
        var hub = $.connection.hub;
        var echo1 = $.connection.echo1;

        var started = hub.start({
            transport: [
                'webSockets',
                'longPolling',
                'serverSentEvents',
                'foreverFrame'
            ]
        });

        echo1.client.message = function (mes) {
            $('#message').append($('<li />').hmtl(mes));
        }

        hub.error(function (error) {
            console.log('An error occurred on the hub connection: ' +
                error);
        });

        //==================== dynamic:================
        started.done(function () {
            $('#connected')
                .html('connected, transport: ' +
                hub.transport.name);

            // send message and get here with value return from server:
            $('#send').click(function () {
                try {
                    echo1.server.returnMessage($('#text').val())
                        .done(function (mes) {
                            $('#message').append($('<li />').html(mes));
                        })
                        .fail(function (error) {
                            console.log('====== error ====', error);
                        })
                } catch (e) {

                }
                
            })
        });
    </script>
</head>
<body>
    <h1>oh hi</h1>
    <h3 id="connected"></h3>
    <input id="text" type="text" placeholder="type message" />
    <button id="send">send</button>
    <ul id="message"></ul>
</body>
</html>